<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="Real stealth game. Real time game. Real multiplayer game. Real online game. This is not a joke.">
    <meta name="keywords" content="2d,stealth,play,online,socket,io,multiplayer,real,time,game">

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="icon" type="image/png" id="icoico" href="/g/stealth/resource/img/favicon.png">
    <title>Stealth, realtime, multiplayer game io</title>
  </head>
  <body onload="initHome()">

    <div id="guitag"></div>

    <script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/g/stealth/resource/js/three.min.js"></script>
    <script src="/g/stealth/resource/js/GLTFLoader.js"></script>

    <script src="/g/stealth/resource/js/addScene.js"></script>
    <script src="/g/stealth/resource/js/setAnimationPlayer.js"></script>

    <script type="text/javascript">
    var socket = io();

    var pressedKeys = {
      w: false,
      s: false,
      d: false,
      a: false,
      hnum1: false,
      rightMouse: false
    };

    var maxCountStep = 30;
    var countStep = maxCountStep-1;
    var speedPlayers = 0.5;
    var speedBullets = 5;
    var movePlayers = function() {
      for (var i = 0; i < objects.length; i++) {
        if (objects[i] && objects[i].tag == 'player' && !objects[i].dead) {
          if (isPlayerIntoNoneGhostObj(objects[i], {x: objects[i].sceneObj.position.x+objects[i].speed.x*speedPlayers, y: objects[i].sceneObj.position.y+objects[i].speed.y*speedPlayers})) {
            if (!isPlayerIntoNoneGhostObj(objects[i], {x: objects[i].sceneObj.position.x+objects[i].speed.x*speedPlayers, y: objects[i].sceneObj.position.y})) {
              objects[i].speed.x = objects[i].speed.x;
              objects[i].speed.y = 0;
            } else if (!isPlayerIntoNoneGhostObj(objects[i], {x: objects[i].sceneObj.position.x, y: objects[i].sceneObj.position.y+objects[i].speed.y*speedPlayers})) {
              objects[i].speed.x = 0;
              objects[i].speed.y = objects[i].speed.y;
            } else {
              objects[i].speed.x = 0;
              objects[i].speed.y = 0;
            }
          }

          objects[i].coord.x += objects[i].speed.x*speedPlayers;
          objects[i].coord.y += objects[i].speed.y*speedPlayers;

          objects[i].sceneObj.position.x = objects[i].coord.x;
          objects[i].sceneObj.position.y = objects[i].coord.y;

          //setNameCoord(i, {x: objects[i].coord.x, y: objects[i].coord.y-10});

          objects[i].nameObj.position.x = objects[i].coord.x-objects[i].shiftName;
          objects[i].nameObj.position.y = objects[i].coord.y;

          if (objects[i].id == idObjMyPlayer && !objects[i].dead) {
            camera.position.x = objects[i].coord.x;
            camera.position.y = objects[i].coord.y;

            eyesLight.position.x = objects[i].coord.x;
            eyesLight.position.y = objects[i].coord.y;

            targetEyesLight.position.x += objects[i].speed.x*speedPlayers;
            targetEyesLight.position.y += objects[i].speed.y*speedPlayers;

            showOtherPlayers();

            if (countStep == maxCountStep) {
              socket.emit('sendAddObjectsS', [{
                tag: 'circle',
                coord: objects[i].coord,
                maxSize: 2
              }]);
              if (i == idObjMyPlayer) {
                if (typeof finishData.steps == 'undefined') { finishData.steps = 0; }
                finishData.steps++;
              }
              countStep = 0;
            }
            if (objects[i].speed.x != 0 || objects[i].speed.y != 0) {countStep++;}

          }

          // if (objects[i].bot === true) {
          //   setAnimationBot(objects[i]);
          // } else {
            setAnimationPlayer(objects[i]);
          // }

          addSizeCirclesStep();
        } else if (i == idObjMyPlayer && objects[idObjMyPlayer].dead) {
          camera.position.x = objects[objects[idObjMyPlayer].spectating].coord.x;
          camera.position.y = objects[objects[idObjMyPlayer].spectating].coord.y;
        } else if (objects[i] && objects[i].tag == 'bullet') {
          var steps = speedBullets/0.5;
          for (var j = 0; j < steps; j++) {
            objects[i].coord.x += objects[i].speed.x*0.5;
            objects[i].coord.y += objects[i].speed.y*0.5;
            objects[i].sceneObj.position.x += objects[i].speed.x*0.5;
            objects[i].sceneObj.position.y += objects[i].speed.y*0.5;

            var recipientBullet = isBulletAreaIntoStopBulletObj({x: objects[i].coord.x, y: objects[i].coord.y});
            if (recipientBullet) {
              if (recipientBullet.tag == "player" && recipientBullet.id == idObjMyPlayer) {
                hurtMe(50, 10);
              } else if (recipientBullet.tag == "player" && recipientBullet.id != idObjMyPlayer && objects[i].idOwner == idObjMyPlayer) {
                addKilling(recipientBullet.id);
                if (recipientBullet.bot === true) {
                  hurtBot(recipientBullet.id, 50, 10);
                }
              } else if (recipientBullet.tag == "player" && recipientBullet.id != idObjMyPlayer && objects[i].idOwner != idObjMyPlayer && recipientBullet.bot === true && amicontrolerbot) {
                hurtBot(recipientBullet.id, 50, 10);
              }
              if (recipientBullet.tag == "player" && objects[objects[i].idOwner].bot === true && recipientBullet.id != objects[i].idOwner && amicontrolerbot) {
                addKillingBot(objects[i].idOwner, recipientBullet.id);
              }
              scene.remove(objects[i].sceneObj);
              delete objects[i];
              break;
            }
          }

        }
      }
    };

    // var setNameCoord = function(id, point) {
    //   var name = objects[id].name;
    //   var myCoord = camera.position;
    //   var newCoord = {};
    //   newCoord.x = point.x-myCoord.x;
    //   newCoord.y = -(point.y-myCoord.y);
    //
    //   if (!document.getElementById(id+'LabelName')) {
    //     var labelName = document.createElement("div");
    //     labelName.setAttribute('id', id+'LabelName');
    //     labelName.innerHTML = name;
    //     labelName.style.position = 'fixed';
    //     labelName.style.zIndex = '10';
    //     document.getElementById('guitag').appendChild(labelName);
    //   }
    //   document.getElementById(id+'LabelName').style.left = (window.innerWidth+newCoord.x)+'px';
    //   document.getElementById(id+'LabelName').style.top = (window.innerHeight+newCoord.y)+'px';
    // };

    var timerBleeding = setInterval(function() {}, 60*60*1000);
    var timeoutShowHealth = setTimeout(function() {}, 1);
    var hurtMe = function(hp, blood) {
      var myPlayer = objects[idObjMyPlayer];
      if (!myPlayer.dead) {

        myPlayer.health -= hp;
        myPlayer.bleeding += blood;

        if (document.getElementById('health')) {
          document.getElementById('health').remove();
        }
        var healthGui = document.createElement("div");
        healthGui.setAttribute("id", "health");
        healthGui.setAttribute("class", "disable-select");
        var color = getColorHealth(myPlayer.health);
        healthGui.style.backgroundColor = "rgb("+color.r+", "+color.g+", "+color.b+")";
        healthGui.style.width = (myPlayer.health)+"%";
        healthGui.style.height = "100px";
        healthGui.style.position = "fixed";
        healthGui.style.left = "0px";
        healthGui.style.top = "0px";
        healthGui.style.opacity = "0.5";
        document.getElementById('guitag').appendChild(healthGui);
        clearTimeout(timeoutShowHealth);
        timeoutShowHealth = setTimeout(function() {
          if (document.getElementById('health')) {
            document.getElementById('health').remove();
          }
        }, 500);

        if (blood > 0) {
          clearInterval(timerBleeding);
          timerBleeding = setInterval(function() {
            hurtMe(1, 0);
          }, (60*1000)/myPlayer.bleeding);
        }

        var coordBlood = {x: myPlayer.coord.x+2*Math.cos(myPlayer.sceneObj.rotation.y-Math.PI/2), y:myPlayer.coord.y+2*Math.sin(myPlayer.sceneObj.rotation.y-Math.PI/2)};
        socket.emit('sendAddObjectsS', [{
          tag: 'blood',
          coord: coordBlood
        }]);
        if (typeof finishData.spotsBlood == 'undefined') { finishData.spotsBlood = 0; }
        finishData.spotsBlood++;

        if (myPlayer.health <= 0) {
          eyesLight.visible = false;
          myPlayer.dead = true;
          myPlayer.sceneObj.rotation.x = 0;
          myPlayer.sceneObj.rotation.y = 0;
          myPlayer.sceneObj.rotation.z = Math.PI/2;
          myPlayer.sceneObj.position.z = 1;
          myPlayer.mixer.stopAllAction();
          myPlayer.mixer.clipAction(THREE.AnimationClip.findByName(myPlayer.animations, 'Standing')).play();
          myPlayer.mixer.clipAction(THREE.AnimationClip.findByName(myPlayer.animations, 'GunStanding')).play();
          myPlayer.mixer.clipAction(THREE.AnimationClip.findByName(myPlayer.animations, 'KnifeStanding')).play();
          myPlayer.health = 0;
          myPlayer.bleeding = 0;
          myPlayer.stopBullet = false;
          socket.emit('sendDeadPlayerS', idObjMyPlayer);
          myPlayer.spectating = idObjMyPlayer;
          showAllPlayers();
          camera.position.z = 80;

          finishData.time = Math.round((Date.now()-timeStartGame)/1000);

          shiftPlaceBots();
        }

        socket.emit('sendChgHpBloodS', idObjMyPlayer, hp, blood);
      }
    };

    var controlerInterval1 = setTimeout(function() {}, 1);
    var controlerInterval2 = setTimeout(function() {}, 1);
    var controlerInterval3 = setTimeout(function() {}, 1);
    var startControlersIntervals = function() {
      controlerInterval1 = setInterval(function() {
        if (amicontrolerbot) {
          for (i in objects) {
            if (objects[i]) {
            if (objects[i].tag == 'player' && objects[i].bot === true && objects[i].bleeding > 0 && objects[i].dead === false) {
              hurtBot(i, 1, 0);
            }
            if (objects[i].tag == 'player' && objects[i].bot === true && objects[i].dead === false) {
              socket.emit('sendAddObjectsS', [{
                tag: 'circle',
                coord: objects[i].coord,
                maxSize: 2
              }]);
              finishDataBots[i].steps++;
            }
            }
          }
          socket.emit('sendCreateFinishDataBotsS', finishDataBots);
        }
      }, 2000);
      controlerInterval2 = setInterval(function() {
        if (amicontrolerbot) {
          for (i in objects) {
            if (objects[i]) {
            if (objects[i].tag == 'player' && objects[i].bot === true && objects[i].dead === false) {
              for (j in objects) {
                if (objects[j].tag == 'player' && objects[j].dead === false && j != i) {
                  var range = Math.sqrt(Math.pow(objects[i].coord.x-objects[j].coord.x, 2)+Math.pow(objects[i].coord.y-objects[j].coord.y, 2));
                  if (range < 15 && !isBetweenObject(objects[i].coord, objects[j].coord)) {
                    var angle = Math.atan(Math.abs(objects[i].coord.y-objects[j].coord.y)/Math.abs(objects[i].coord.x-objects[j].coord.x));
                    if (objects[j].coord.x < objects[i].coord.x && objects[j].coord.y > objects[i].coord.y) {
                      angle = Math.PI-angle;
                    } else if (objects[j].coord.x < objects[i].coord.x && objects[j].coord.y < objects[i].coord.y) {
                      angle = Math.PI+angle;
                    } else if (objects[j].coord.x > objects[i].coord.x && objects[j].coord.y < objects[i].coord.y) {
                      angle = 2*Math.PI-angle;
                    }
                    objects[i].sceneObj.rotation.y = angle+Math.PI/2;
                    objects[i].aiming = true;
                    socket.emit('rotatePlayerS', i, objects[i].sceneObj.rotation.y, objects[i].lookingDirect);
                    shootBot(objects[i], angle);
                  }
                }
              }
            }
            }
          }
        }
      }, 3000);
      controlerInterval3 = setInterval(function() {
        if (amicontrolerbot) {
          for (i in objects) {
            if (objects[i]) {
            if (objects[i].tag == 'player' && objects[i].bot === true && objects[i].dead === false) {
              objects[i].lookingDirect = Math.floor(getRandom(1, 9));
              objects[i].sceneObj.rotation.y = (objects[i].lookingDirect-1)*Math.PI/4-Math.PI/2;
              socket.emit('rotatePlayerS', i, objects[i].sceneObj.rotation.y, objects[i].lookingDirect);
              socket.emit('sendChgSpeedPlayerS', i, Math.floor(getRandom(0, 3))-1, Math.floor(getRandom(0, 3))-1);
            }
            }
          }
        }
      }, 5000);
    };

    var hurtBot = function(id, hp, blood) {
      var player = objects[id];
      if (!player.dead) {

        player.health -= hp;
        player.bleeding += blood;

        var coordBlood = {x: player.coord.x+2*Math.cos(player.sceneObj.rotation.y-Math.PI/2), y:player.coord.y+2*Math.sin(player.sceneObj.rotation.y-Math.PI/2)};
        socket.emit('sendAddObjectsS', [{
          tag: 'blood',
          coord: coordBlood
        }]);
        finishDataBots[id].spotsBlood++;
        socket.emit('sendCreateFinishDataBotsS', finishDataBots);

        if (player.health <= 0) {
          player.dead = true;
          player.sceneObj.rotation.x = 0;
          player.sceneObj.rotation.y = 0;
          player.sceneObj.rotation.z = Math.PI/2;
          player.sceneObj.position.z = 1;
          player.mixer.stopAllAction();
          player.mixer.clipAction(THREE.AnimationClip.findByName(player.animations, 'Standing')).play();
          player.mixer.clipAction(THREE.AnimationClip.findByName(player.animations, 'GunStanding')).play();
          player.mixer.clipAction(THREE.AnimationClip.findByName(player.animations, 'KnifeStanding')).play();
          player.health = 0;
          player.bleeding = 0;
          player.stopBullet = false;
          player.spectating = id;
          socket.emit('sendDeadPlayerS', id);
          if (!objects[idObjMyPlayer].dead) {
            finishData.place--;
          }
          shiftPlaceBots();
          finishDataBots[id].time = Math.round((Date.now()-finishDataBots[id].time)/1000);
          socket.emit('sendCreateFinishDataBotsS', finishDataBots);
        }

        socket.emit('sendChgHpBloodS', id, hp, blood);
      }
    };

    var shiftPlaceBots = function() {
      for (i in objects) {
        if (objects[i]) {
        if (objects[i].tag == 'player' && objects[i].bot === true && objects[i].dead === false) {
          finishDataBots[i].place--;
        }
        }
      }
      socket.emit('sendCreateFinishDataBotsS', finishDataBots);
    };

    var showAllPlayers = function() {
      for (i in objects) {
        if (objects[i].tag == 'player' || objects[i].tag == 'blood') {
          objects[i].sceneObj.visible = true;
        }
      }
    };

    var getColorHealth = function(health) {
      var pointsGradient = {};
      var percent = 0;
      if (health <= 50) {
        pointsGradient.p1 = {r: 225, g: 0, b: 0};
        pointsGradient.p2 = {r: 225, g: 225, b: 0};
        percent = health/50;
      } else if (health > 50) {
        pointsGradient.p1 = {r: 225, g: 225, b: 0};
        pointsGradient.p2 = {r: 0, g: 225, b: 0};
        percent = (health-50)/50;
      }
      return {r: pointsGradient.p1.r+percent*(pointsGradient.p2.r-pointsGradient.p1.r), g: pointsGradient.p1.g+percent*(pointsGradient.p2.g-pointsGradient.p1.g), b: pointsGradient.p1.b+percent*(pointsGradient.p2.b-pointsGradient.p1.b)};
    };

    var addSizeCirclesStep = function() {
      for (i in objects) {
        if (objects[i].tag == "circle") {
          if (objects[i].sceneObj.scale.x >= objects[i].maxSize) {
            scene.remove(objects[i].sceneObj);
            // delete objects[i];
            continue;
          }
          objects[i].sceneObj.scale.x += 0.03;
          objects[i].sceneObj.scale.y += 0.03;
          var range = Math.sqrt(Math.pow(objects[idObjMyPlayer].coord.x-objects[i].coord.x, 2)+Math.pow(objects[idObjMyPlayer].coord.y-objects[i].coord.y, 2));
          if (range <= 10*objects[i].sceneObj.scale.x) {
            objects[i].sceneObj.visible = true;
          } else if (range >= 10*objects[i].sceneObj.scale.x) {
            objects[i].sceneObj.visible = false;
          }
        }
      }
    };

    var isPlayerIntoNoneGhostObj = function(player, point) {
      var sizePlayer = {w: 2, h: 2, d: 5};
      for (var i = 0; i < objects.length; i++) {
        if (objects[i] && objects[i].ghostMode == "2") {
          if ( (point.x-sizePlayer.w/2 >= objects[i].sceneObj.position.x-objects[i].size.w/2 && point.x-sizePlayer.w/2 <= objects[i].sceneObj.position.x+objects[i].size.w/2) || (point.x+sizePlayer.w/2 >= objects[i].sceneObj.position.x-objects[i].size.w/2 && point.x+sizePlayer.w/2 <= objects[i].sceneObj.position.x+objects[i].size.w/2) || (objects[i].sceneObj.position.x-objects[i].size.w/2 >= point.x-sizePlayer.w/2 && objects[i].sceneObj.position.x-objects[i].size.w/2 <= point.x+sizePlayer.w/2) || (objects[i].sceneObj.position.x+objects[i].size.w/2 >= point.x-sizePlayer.w/2 && objects[i].sceneObj.position.x+objects[i].size.w/2 <= point.x+sizePlayer.w/2) ) {
            if ( (point.y-sizePlayer.h/2 >= objects[i].sceneObj.position.y-objects[i].size.h/2 && point.y-sizePlayer.h/2 <= objects[i].sceneObj.position.y+objects[i].size.h/2) || (point.y+sizePlayer.h/2 >= objects[i].sceneObj.position.y-objects[i].size.h/2 && point.y+sizePlayer.h/2 <= objects[i].sceneObj.position.y+objects[i].size.h/2) || (objects[i].sceneObj.position.y-objects[i].size.h/2 >= point.y-sizePlayer.h/2 && objects[i].sceneObj.position.y-objects[i].size.h/2 <= point.y+sizePlayer.h/2) || (objects[i].sceneObj.position.y+objects[i].size.h/2 >= point.y-sizePlayer.h/2 && objects[i].sceneObj.position.y+objects[i].size.h/2 <= point.y+sizePlayer.h/2) ) {
              return true;
            }
          }
        }
      }
      return false;
    };

    var showOtherPlayers = function() {
      for (var i = 0; i < objects.length; i++) {
        if (objects[i] && i != idObjMyPlayer && (objects[i].tag == "player" || objects[i].tag == "bullet" || objects[i].tag == "blood")) {
        //if (objects[i] && i != idObjMyPlayer && (objects[i].tag == "player")) {
          var range = Math.sqrt(Math.pow(objects[idObjMyPlayer].coord.x-objects[i].coord.x, 2)+Math.pow(objects[idObjMyPlayer].coord.y-objects[i].coord.y, 2));
          if (range < 20) {
            var myAngle = objects[idObjMyPlayer].sceneObj.rotation.y;
            if (myAngle >= 0 && myAngle < Math.PI/2) {
              myAngle += Math.PI*3/2;
            } else if (myAngle >= Math.PI/2 && myAngle <= Math.PI*3/2) {
              myAngle -= Math.PI/2;
            } else if (myAngle < 0) {
              myAngle = Math.PI*3/2-Math.abs(myAngle);
            }

            var angleOther = Math.atan(Math.abs(objects[idObjMyPlayer].coord.y-objects[i].coord.y)/Math.abs(objects[idObjMyPlayer].coord.x-objects[i].coord.x));
            if (objects[i].coord.x <= objects[idObjMyPlayer].coord.x && objects[i].coord.y >= objects[idObjMyPlayer].coord.y) {
              angleOther = Math.PI-angleOther;
            } else if (objects[i].coord.x <= objects[idObjMyPlayer].coord.x && objects[i].coord.y <= objects[idObjMyPlayer].coord.y) {
              angleOther = Math.PI+angleOther;
            } else if (objects[i].coord.x >= objects[idObjMyPlayer].coord.x && objects[i].coord.y <= objects[idObjMyPlayer].coord.y) {
              angleOther = 2*Math.PI-angleOther;
            }

            if (Math.abs(myAngle-angleOther) < Math.PI/4 || 2*Math.PI-Math.abs(myAngle-angleOther) < Math.PI/4) {
              if (!isBetweenObject(objects[idObjMyPlayer].coord, objects[i].coord)) {
                objects[i].sceneObj.visible = true;
                if (objects[i].tag == "player") {
                  objects[i].nameObj.visible = true;
                }
              } else {
                objects[i].sceneObj.visible = false;
                if (objects[i].tag == "player") {
                  objects[i].nameObj.visible = false;
                }
              }
            } else {
              objects[i].sceneObj.visible = false;
              if (objects[i].tag == "player") {
                objects[i].nameObj.visible = false;
              }
            }
          } else {
            objects[i].sceneObj.visible = false;
            if (objects[i].tag == "player") {
              objects[i].nameObj.visible = false;
            }
          }
        }
      }
    };

    var isBetweenObject = function(p1, p2) {
      var step = 0.9;
      var length = Math.sqrt(Math.pow(p2.x-p1.x, 2)+Math.pow(p2.y-p1.y, 2));
      var steps = length/step;
      var angle = Math.atan(Math.abs(p1.y-p2.y)/Math.abs(p1.x-p2.x));
      var dx = step*Math.cos(angle);
      var dy = step*Math.sin(angle);
      if (p2.x <= p1.x && p2.y >= p1.y) {
        dx = -dx;
      } else if (p2.x <= p1.x && p2.y <= p1.y) {
        dx = -dx;
        dy = -dy;
      } else if (p2.x >= p1.x && p2.y <= p1.y) {
        dy = -dy;
      }
      for (var i = 0; i < steps; i++) {
        if (isPointInsideObjectUnvisible({x: p1.x+i*dx, y: p1.y+i*dy})) {
          return true;
        }
      }
      return false;
    };

    var isPointInsideObjectUnvisible = function(point) {
      for (var i in objects) {
        if (objects[i].visibleThrough != "undefined" && objects[i].visibleThrough == false) {
          if (point.x > objects[i].sceneObj.position.x-objects[i].size.w/2 && point.x < objects[i].sceneObj.position.x+objects[i].size.w/2) {
            if (point.y > objects[i].sceneObj.position.y-objects[i].size.h/2 && point.y < objects[i].sceneObj.position.y+objects[i].size.h/2) {
              return true;
            }
          }
        }
      }
      return false;
    };

    var isBulletAreaIntoStopBulletObj = function(point) {
      var sizeBulletArea = {w: 0.1, h: 0.1, d: 0.1};
      for (var i = 0; i < objects.length; i++) {
        if (objects[i] && objects[i].stopBullet == true) {
          if ( (point.x-sizeBulletArea.w/2 >= objects[i].sceneObj.position.x-objects[i].size.w/2 && point.x-sizeBulletArea.w/2 <= objects[i].sceneObj.position.x+objects[i].size.w/2) || (point.x+sizeBulletArea.w/2 >= objects[i].sceneObj.position.x-objects[i].size.w/2 && point.x+sizeBulletArea.w/2 <= objects[i].sceneObj.position.x+objects[i].size.w/2) || (objects[i].sceneObj.position.x-objects[i].size.w/2 >= point.x-sizeBulletArea.w/2 && objects[i].sceneObj.position.x-objects[i].size.w/2 <= point.x+sizeBulletArea.w/2) || (objects[i].sceneObj.position.x+objects[i].size.w/2 >= point.x-sizeBulletArea.w/2 && objects[i].sceneObj.position.x+objects[i].size.w/2 <= point.x+sizeBulletArea.w/2) ) {
            if ( (point.y-sizeBulletArea.h/2 >= objects[i].sceneObj.position.y-objects[i].size.h/2 && point.y-sizeBulletArea.h/2 <= objects[i].sceneObj.position.y+objects[i].size.h/2) || (point.y+sizeBulletArea.h/2 >= objects[i].sceneObj.position.y-objects[i].size.h/2 && point.y+sizeBulletArea.h/2 <= objects[i].sceneObj.position.y+objects[i].size.h/2) || (objects[i].sceneObj.position.y-objects[i].size.h/2 >= point.y-sizeBulletArea.h/2 && objects[i].sceneObj.position.y-objects[i].size.h/2 <= point.y+sizeBulletArea.h/2) || (objects[i].sceneObj.position.y+objects[i].size.h/2 >= point.y-sizeBulletArea.h/2 && objects[i].sceneObj.position.y+objects[i].size.h/2 <= point.y+sizeBulletArea.h/2) ) {
              return objects[i];
            }
          }
        }
      }
      return false;
    };

    var sendMove = function() {
      if (pressedKeys.w && !pressedKeys.s) {
        socket.emit('sendChgSpeedPlayerS', idObjMyPlayer, null, 1);
      }
      if (!pressedKeys.w && pressedKeys.s) {
        socket.emit('sendChgSpeedPlayerS', idObjMyPlayer, null, -1);
      }
      if ((!pressedKeys.w && !pressedKeys.s) || (pressedKeys.w && pressedKeys.s)) {
        socket.emit('sendChgSpeedPlayerS', idObjMyPlayer, null, 0);
      }
      if (pressedKeys.d && !pressedKeys.a) {
        socket.emit('sendChgSpeedPlayerS', idObjMyPlayer, 1, null);
      }
      if (!pressedKeys.d && pressedKeys.a) {
        socket.emit('sendChgSpeedPlayerS', idObjMyPlayer, -1, null);
      }
      if ((!pressedKeys.d && !pressedKeys.a) || (pressedKeys.d && pressedKeys.a)) {
        socket.emit('sendChgSpeedPlayerS', idObjMyPlayer, 0, null);
      }
    };

    var objects = [];

    var idObjMyPlayer = null;
    var intervalRespawn = setTimeout(function() {}, 1);
    function respawn(coords) {
      var lengthMap = 418;

      if (document.getElementById('loading')) {
        document.getElementById('loading').remove();
      }
      var loading = document.createElement("div");
      loading.setAttribute("id", "loading");
      loading.setAttribute("class", "disable-select");
      loading.innerHTML = "map generating";
      loading.style.width = "100%";
      loading.style.height = "100%";
      loading.style.position = "fixed";
      loading.style.left = "0px";
      loading.style.bottom = "0px";
      loading.style.display = "flex";
      loading.style.flexDirection = "column";
      loading.style.justifyContent = "center";
      loading.style.alignItems = "center";
      loading.style.fontSize = "16px";
      loading.style.fontFamily = "Arial";
      loading.style.color = "#fff";
      loading.style.fontWeight = "100";
      loading.style.backgroundColor = "#000";
      loading.style.zIndex = "1000";
      document.getElementById('guitag').appendChild(loading);

      intervalRespawn = setInterval(function() {
        //console.log(objects.length/lengthMap);
        if (objects.length >= lengthMap) {
          var coordSpawn = {
            x: Math.round(getRandom(-100, 100)),
            y: Math.round(getRandom(-100, 100))
          };
          var flagSpawn = isPlayerIntoNoneGhostObj(objects[idObjMyPlayer], coordSpawn);
          if (!flagSpawn) {
            clearInterval(intervalRespawn);
            camera.position.x = coordSpawn.x;
            camera.position.y = coordSpawn.y;
            var name = getCookie('name');
            if (!name) {
              name = '';
            }
            socket.emit('sendAddObjectsS', [{
              tag: 'player',
              coord: coordSpawn,
              speed: {x: 0, y: 0},
              name: name
            }], 'me');
            setTimeout(function() {
              document.getElementById('loading').remove();
              if (amicontrolerbot) {
                respawnBots();
                setFinishDataBots();
              }
            }, 1500);
          }
        }
      }, 1000);
    }

    var respawnBots = function() {
      for (i in objects) {
        if (objects[i].tag == 'player') {
        if (objects[i].bot === true) {
          var flagSpawn;
          var coordSpawn;
          do {
            coordSpawn = {
              x: Math.round(getRandom(-100, 100)),
              y: Math.round(getRandom(-100, 100))
            };
            flagSpawn = isPlayerIntoNoneGhostObj(objects[i], coordSpawn);
          } while (flagSpawn);
          objects[i].coord = coordSpawn;
          socket.emit('sendMyCoordToAllS', i, coordSpawn);
        }
        }
      }
      startControlersIntervals();
    };

    var setFinishDataBots = function() {
      for (i in objects) {
        if (objects[i].tag == 'player' && objects[i].bot === true) {
          finishDataBots[i] = {
            id: i,
            place: finishData.place,
            time: Date.now(),
            name: '',
            shoots: 0,
            kills: [],
            spotsBlood: 0,
            steps: 0
          };
        }
      }
      socket.emit('sendCreateFinishDataBotsS', finishDataBots);
    };

    function getRandom(min, max) {
      return Math.random() * (max - min) + min;
    }

    var setSizeWindow = function() {
      document.body.style.width = window.innerWidth+"px";
      document.body.style.height = window.innerHeight+"px";
      renderer.setSize(window.innerWidth-10, window.innerHeight-10);
      camera.aspect = (window.innerWidth-10)/(window.innerHeight-10);
      camera.updateProjectionMatrix();
    };

    var keyDownHome = function(e) {
      switch (e.code) {
        case 'Digit1':
          if (!pressedKeys.hnum1) {
            pressedKeys.hnum1 = true;
            // switchSearchGame();
          }
          break;
      }
    };

    var keyUpHome = function(e) {
      switch (e.code) {
        case 'Digit1':
          if (pressedKeys.hnum1) {
            pressedKeys.hnum1 = false;
          }
          break;
      }
    };

    var keyDownGame = function(e) {
      switch (e.code) {
        case 'KeyW':
          if (!pressedKeys.w) {
            pressedKeys.w = true;
          }
          break;
        case 'KeyD':
          if (!pressedKeys.d) {
            pressedKeys.d = true;
          }
          break;
        case 'KeyS':
          if (!pressedKeys.s) {
            pressedKeys.s = true;
          }
          break;
        case 'KeyA':
          if (!pressedKeys.a) {
            pressedKeys.a = true;
          }
          break;
        case 'ArrowRight':
          if (objects[idObjMyPlayer].dead) {
            slideSpectating(1);
          }
          break;
        case 'ArrowLeft':
          if (objects[idObjMyPlayer].dead) {
            slideSpectating(-1);
          }
          break;
      }
      sendMove();
    };

    var keyUpGame = function(e) {
      switch (e.code) {
        case 'KeyW':
          if (pressedKeys.w) {
            pressedKeys.w = false;
          }
          break;
        case 'KeyD':
          if (pressedKeys.d) {
            pressedKeys.d = false;
          }
          break;
        case 'KeyS':
          if (pressedKeys.s) {
            pressedKeys.s = false;
          }
          break;
        case 'KeyA':
          if (pressedKeys.a) {
            pressedKeys.a = false;
          }
          break;
      }
      sendMove();
    };

    var slideSpectating = function(direction) {
      var myPlayer = objects[idObjMyPlayer];
      if (direction == 1) {
        var flagSwitch = true;
        for (var i = myPlayer.spectating+1; i < objects.length; i++) {
          if (typeof objects[i] != 'undefined' && objects[i].tag == 'player') {
            myPlayer.spectating = i;
            flagSwitch = false;
            break;
          }
        }
        if (flagSwitch) {
          for (var i = 0; i < objects.length; i++) {
            if (typeof objects[i] != 'undefined' && objects[i].tag == "player") {
              myPlayer.spectating = i;
              break;
            }
          }
        }
      } else if (direction == -1) {
        var flagSwitch = true;
        for (var i = myPlayer.spectating-1; i >= 0; i--) {
          if (typeof objects[i] != 'undefined' && objects[i].tag == 'player') {
            myPlayer.spectating = i;
            flagSwitch = false;
            break;
          }
        }
        if (flagSwitch) {
          for (var i = objects.length-1; i >= 0; i--) {
            if (typeof objects[i] != 'undefined' && objects[i].tag == 'player') {
              myPlayer.spectating = i;
              break;
            }
          }
        }
      }
    };

    var cancelContextRightClick = function(e) {
      e.preventDefault();
    };

    var aimGunDown = function(e) {
      if (e.button == 2) {
        pressedKeys.rightMouse = true;
        objects[idObjMyPlayer].aiming = true;
        socket.emit('sendActionS', idObjMyPlayer, "aiming", true);
        setAnimationPlayer(objects[idObjMyPlayer]);
      }
    };

    var aimGunUp = function(e) {
      if (e.button == 2) {
        pressedKeys.rightMouse = false;
        objects[idObjMyPlayer].aiming = false;
        socket.emit('sendActionS', idObjMyPlayer, "aiming", false);
        setAnimationPlayer(objects[idObjMyPlayer]);
      }
    };

    var wheelUsage = true;
    var changeWeapon = function(e) {
      if (wheelUsage) {
        var myPlayer = objects[idObjMyPlayer];

        switchWeapon(myPlayer);
        showGuiWeapon(myPlayer.activeWeapon);
        showGuiBullets();
        socket.emit('sendActionS', idObjMyPlayer, "changeWeapon", myPlayer.activeWeapon);

        wheelUsage = false;
        setTimeout(function() {
          wheelUsage = true;
        }, 500);
      }
    };

    var switchWeapon = function(obj) {
      if (obj.activeWeapon == 1) {
        obj.activeWeapon = 2;
        visibleObj(obj, "GunObj", false);
        visibleObj(obj, "KnifeObj", true);
      } else if (obj.activeWeapon == 2) {
        obj.activeWeapon = 1;
        visibleObj(obj, "GunObj", true);
        visibleObj(obj, "KnifeObj", false);
      }
    };

    var timeoutChangeWeapon = setTimeout(function() {}, 1);
    var showGuiWeapon = function(weapon) {
      if (document.getElementById('imgWeapon')) {
        document.getElementById('imgWeapon').remove();
      }
      var imgWeapon = document.createElement("img");
      imgWeapon.setAttribute("id", "imgWeapon");
      imgWeapon.setAttribute("class", "disable-select");
      if (weapon == 1) {
        imgWeapon.setAttribute("src", "/g/stealth/resource/img/imgGun.png");
      } else if (weapon == 2) {
        imgWeapon.setAttribute("src", "/g/stealth/resource/img/imgKnife.png");
      }
      imgWeapon.style.width = "200px";
      imgWeapon.style.height = "200px";
      imgWeapon.style.position = "fixed";
      imgWeapon.style.left = "0px";
      imgWeapon.style.bottom = "0px";
      document.getElementById('guitag').appendChild(imgWeapon);

      clearTimeout(timeoutChangeWeapon);
      timeoutChangeWeapon = setTimeout(function() {
        if (document.getElementById('imgWeapon')) {
          document.getElementById('imgWeapon').remove();
        }
      }, 3000);
    };

    var timeoutBullets = setTimeout(function() {}, 1);
    var showGuiBullets = function() {
      if (objects[idObjMyPlayer].activeWeapon == 1) {
        if (document.getElementById('bulletsGui')) {
          document.getElementById('bulletsGui').remove();
        }
        var bulletsGui = document.createElement("div");
        bulletsGui.innerHTML = objects[idObjMyPlayer].bullets;
        bulletsGui.setAttribute("id", "bulletsGui");
        bulletsGui.setAttribute("class", "disable-select");
        bulletsGui.style.padding = "10px";
        bulletsGui.style.position = "fixed";
        bulletsGui.style.left = "0px";
        bulletsGui.style.bottom = "0px";
        bulletsGui.style.fontSize = "20px";
        bulletsGui.style.textAlign = "center";
        bulletsGui.style.fontFamily = "Arial";
        bulletsGui.style.color = "#ffffff";
        bulletsGui.style.backgroundColor = "#00000077";
        document.getElementById('guitag').appendChild(bulletsGui);

        clearTimeout(timeoutBullets);
        timeoutBullets = setTimeout(function() {
          if (document.getElementById('bulletsGui')) {
            document.getElementById('bulletsGui').remove();
          }
        }, 3000);
      } else if (document.getElementById('bulletsGui')) {
        document.getElementById('bulletsGui').remove();
      }
    };

    var visibleObj = function(obj, name, boolean) {
      for (var i = 0; i < obj.sceneObj.children.length; i++) {
        if (obj.sceneObj.children[i].name == name) {
          obj.sceneObj.children[i].visible = boolean;
          break;
        }
      }
    };

    var stabUsage = true;
    var stab = function(e) {
      var myPlayer = objects[idObjMyPlayer];
      if (e.button == 0 && myPlayer.activeWeapon == 2 && stabUsage) {
        socket.emit('sendActionS', idObjMyPlayer, "stab", false);
        makeStab(myPlayer);
        stabUsage = false;
        setTimeout(function() {
          stabUsage = true;
        }, 500);
      }
    };

    var makeStab = function(obj) {
      var action = obj.mixer.clipAction(THREE.AnimationClip.findByName(obj.animations, 'Stab'));
      action.setLoop(THREE.LoopOnce);
      action.play();
      var action2 = obj.mixer.clipAction(THREE.AnimationClip.findByName(obj.animations, 'KnifeStab')).play();
      action2.setLoop(THREE.LoopOnce);
      action2.play();

      setTimeout(function() {
        action.stop();
        action2.stop();
      }, 500);

      if (obj.id != idObjMyPlayer) {
        var coordKnife = {x: obj.coord.x+2*Math.cos(obj.sceneObj.rotation.y-Math.PI/2), y:obj.coord.y+2*Math.sin(obj.sceneObj.rotation.y-Math.PI/2)};
        var range = Math.sqrt(Math.pow(coordKnife.x-objects[idObjMyPlayer].coord.x, 2)+Math.pow(coordKnife.y-objects[idObjMyPlayer].coord.y, 2));
        if (range < 3) {
          hurtMe(10, 5);
        }
      } else if (obj.id == idObjMyPlayer) {
        var coordKnife = {x: obj.coord.x+2*Math.cos(obj.sceneObj.rotation.y-Math.PI/2), y:obj.coord.y+2*Math.sin(obj.sceneObj.rotation.y-Math.PI/2)};
        for (var i = 0; i < objects.length; i++) {
          if (typeof objects[i] != 'undefined' && objects[i].tag == 'player' && i != idObjMyPlayer) {
            var range = Math.sqrt(Math.pow(coordKnife.x-objects[i].coord.x, 2)+Math.pow(coordKnife.y-objects[i].coord.y, 2));
            if (range < 3) {
              addKilling(i);
              if (objects[i].bot === true) {
                hurtBot(i, 10, 5);
              }
            }
          }
        }
      }
    };

    var addKilling = function(id) {
      var flagAdd = true;
      for (var i = 0; i < objects[idObjMyPlayer].killing.length; i++) {
        if (objects[idObjMyPlayer].killing[i] == id) {
          flagAdd = false;
          break;
        }
      }
      if (flagAdd) {
         objects[idObjMyPlayer].killing[objects[idObjMyPlayer].killing.length] = id;
      }
    };

    var addKillingBot = function(idBot, idKills) {
      var flagAdd = true;
      for (var i = 0; i < finishDataBots[idBot].kills.length; i++) {
        if (finishDataBots[idBot].kills[i] == idKills) {
          flagAdd = false;
          break;
        }
      }
      if (flagAdd) {
         finishDataBots[idBot].kills[finishDataBots[idBot].kills.length] = idKills;
         socket.emit('sendCreateFinishDataBotsS', finishDataBots);
      }
    };

    var shoot = function(e) {
      var myPlayer = objects[idObjMyPlayer];
      if (e.button == 0 && pressedKeys.rightMouse && myPlayer.activeWeapon == 1 && myPlayer.bullets > 0) {
        if (typeof finishData.shoots == 'undefined') { finishData.shoots = 0; }
        finishData.shoots++;
        var mouse = {
          x: e.pageX,
          y: e.pageY
        }
        var center = {
          x: window.innerWidth/2,
          y: window.innerHeight/2
        }
        var angle = Math.atan(Math.abs(center.y-mouse.y)/Math.abs(center.x-mouse.x));
        if (mouse.x < center.x && mouse.y < center.y) {
          angle = Math.PI-angle;
        } else if (mouse.x < center.x && mouse.y > center.y) {
          angle = Math.PI+angle;
        } else if (mouse.x > center.x && mouse.y > center.y) {
          angle = 2*Math.PI-angle;
        }

        myPlayer.bullets--;
        showGuiBullets();

        socket.emit('sendAddObjectsS', [{
          tag: 'bullet',
          coord: {x: myPlayer.coord.x+Math.cos(angle)*2*myPlayer.size.w, y: myPlayer.coord.y+Math.sin(angle)*2*myPlayer.size.w},
          speed: {x: Math.cos(angle), y: Math.sin(angle)},
          idOwner: idObjMyPlayer
        }, {
          tag: 'circle',
          coord: myPlayer.coord,
          maxSize: 4
        }]);
      }
    };

    var shootBot = function(obj, angle) {
      socket.emit('sendAddObjectsS', [{
        tag: 'bullet',
        coord: {x: obj.coord.x+Math.cos(angle)*2*obj.size.w, y: obj.coord.y+Math.sin(angle)*2*obj.size.w},
        speed: {x: Math.cos(angle), y: Math.sin(angle)},
        idOwner: obj.id
      }, {
        tag: 'circle',
        coord: obj.coord,
        maxSize: 4
      }]);

      finishDataBots[obj.id].shoots++;
      socket.emit('sendCreateFinishDataBotsS', finishDataBots);
    };

    var rotateMe = function(e) {
      if (!objects[idObjMyPlayer].dead) {
      var mouse = {
        x: e.pageX,
        y: e.pageY
      }
      var center = {
        x: window.innerWidth/2,
        y: window.innerHeight/2
      }
      var angle = Math.atan(Math.abs(center.y-mouse.y)/Math.abs(center.x-mouse.x));

      if (mouse.x > center.x && mouse.y < center.y) {
        // quater 1
        targetEyesLight.position.x = objects[idObjMyPlayer].coord.x+Math.cos(angle);
        targetEyesLight.position.y = objects[idObjMyPlayer].coord.y+Math.sin(angle);

        objects[idObjMyPlayer].sceneObj.rotation.y = angle+Math.PI/2;
        if (angle <= Math.PI/6) {
          objects[idObjMyPlayer].lookingDirect = 1;
        } else if (angle > Math.PI/6 && angle < 2*Math.PI/6) {
          objects[idObjMyPlayer].lookingDirect = 2;
        } else if (angle >= 2*Math.PI/6) {
          objects[idObjMyPlayer].lookingDirect = 3;
        }
      } else if (mouse.x < center.x && mouse.y < center.y) {
        // quater 2
        targetEyesLight.position.x = objects[idObjMyPlayer].coord.x-Math.cos(angle);
        targetEyesLight.position.y = objects[idObjMyPlayer].coord.y+Math.sin(angle);

        objects[idObjMyPlayer].sceneObj.rotation.y = Math.PI-angle+Math.PI/2;
        if (angle <= Math.PI/6) {
          objects[idObjMyPlayer].lookingDirect = 5;
        } else if (angle > Math.PI/6 && angle < 2*Math.PI/6) {
          objects[idObjMyPlayer].lookingDirect = 4;
        } else if (angle >= 2*Math.PI/6) {
          objects[idObjMyPlayer].lookingDirect = 3;
        }
      } else if (mouse.x < center.x && mouse.y > center.y) {
        // quater 3
        targetEyesLight.position.x = objects[idObjMyPlayer].coord.x-Math.cos(angle);
        targetEyesLight.position.y = objects[idObjMyPlayer].coord.y-Math.sin(angle);

        objects[idObjMyPlayer].sceneObj.rotation.y = -(Math.PI-angle)+Math.PI/2;
        if (angle <= Math.PI/6) {
          objects[idObjMyPlayer].lookingDirect = 5;
        } else if (angle > Math.PI/6 && angle < 2*Math.PI/6) {
          objects[idObjMyPlayer].lookingDirect = 6;
        } else if (angle >= 2*Math.PI/6) {
          objects[idObjMyPlayer].lookingDirect = 7;
        }
      } else if (mouse.x > center.x && mouse.y > center.y) {
        // quater 4
        targetEyesLight.position.x = objects[idObjMyPlayer].coord.x+Math.cos(angle);
        targetEyesLight.position.y = objects[idObjMyPlayer].coord.y-Math.sin(angle);

        objects[idObjMyPlayer].sceneObj.rotation.y = -angle+Math.PI/2;
        if (angle <= Math.PI/6) {
          objects[idObjMyPlayer].lookingDirect = 1;
        } else if (angle > Math.PI/6 && angle < 2*Math.PI/6) {
          objects[idObjMyPlayer].lookingDirect = 8;
        } else if (angle >= 2*Math.PI/6) {
          objects[idObjMyPlayer].lookingDirect = 7;
        }
      }

      socket.emit('rotatePlayerS', idObjMyPlayer, objects[idObjMyPlayer].sceneObj.rotation.y, objects[idObjMyPlayer].lookingDirect);
      }
    };

    var update = function() {
      movePlayers();
      for (i in objects) {
        if (objects[i].mixer) {
          objects[i].mixer.update(deltaClock);
        }
      }
    };

    var render = function() {
      renderer.render(scene, camera);
    };

    var clock = new THREE.Clock();
    var deltaClock = 0;
    var loop = function() {
      requestAnimationFrame(loop);

      deltaClock = clock.getDelta();

      update();
      render();
    };

    // var switchSearchGame = function() {
    //   var textDom = document.getElementById('textSearchingGame');
    //   if (textDom.getAttribute('searching') == "false") {
    //     textDom.setAttribute('searching', true);
    //     textDom.innerHTML = 'press 1 to cancel searching';
    //     socket.emit('switchSearchingGameS');
    //   } else if (textDom.getAttribute('searching') == "true") {
    //     textDom.setAttribute('searching', false);
    //     textDom.innerHTML = 'press 1 to search game';
    //     socket.emit('switchSearchingGameS');
    //   }
    // };

    var switchSearchGame = function() {
      var buttonSearch = document.getElementById('searchGame');
      if (buttonSearch.getAttribute('searching') == 'false') {
        buttonSearch.setAttribute('searching', 'true');
        buttonSearch.innerHTML = 'Searching game';
        animateSearchButton(true);
        socket.emit('switchSearchingGameS');
      } else if (buttonSearch.getAttribute('searching') == 'true') {
        buttonSearch.setAttribute('searching', 'false');
        buttonSearch.innerHTML = 'Search game';
        animateSearchButton(false);
        socket.emit('switchSearchingGameS');
      }
    };

    var intervalAnimateSearchButton = setTimeout(function() {}, 1);
    var animateSearchButton = function(key) {
      if (key == 1) {
        document.getElementById('searchGame').style.opacity = '0.4';
        intervalAnimateSearchButton = setTimeout(function() {
          animateSearchButton(2);
        }, 1000);
      } else if (key == 2) {
        document.getElementById('searchGame').style.opacity = '1';
        intervalAnimateSearchButton = setTimeout(function() {
          animateSearchButton(1);
        }, 1000);
      } else if (key == 0) {
        document.getElementById('searchGame').style.opacity = '1';
        clearInterval(intervalAnimateSearchButton);
      }
    }

    var timeoutSaveName = setTimeout(function() {}, 1);
    var saveName = function() {
      clearInterval(timeoutSaveName);
      timeoutSaveName = setTimeout(function() {
        var name = document.getElementById('inputName').value;
        setCookie('name', name, 30);
      }, 1000);
    };
    function isChild(parent, child) {
      var node = child.parentNode;
      while (node != null) {
         if (node == parent) {
             return true;
         }
         node = node.parentNode;
      }
      return false;
    }

    var downPressContact = false;
    window.addEventListener("mousedown", function(e) {
      if (document.getElementById('contentContactForm') != e.target && !isChild(document.getElementById('contentContactForm'), e.target)) {
        downPressContact = true;
      } else {
        downPressContact = false;
      }
    });
    window.addEventListener("mouseup", function(e) {
      if (document.getElementById('contentContactForm') != e.target && !isChild(document.getElementById('contentContactForm'), e.target) && downPressContact) {
        hideContactForm();
      } else {
        downPressContact = false;
      }
    });
    var showContactForm = function() {
      document.getElementById('backContactForm').style.display = 'flex';
    }
    var hideContactForm = function() {
      document.getElementById('backContactForm').style.display = 'none';
    }

    var refreshContactStroke = function(e) {
      if (e.value == "other") {
        document.getElementById('inputTypeNameContact').style.display = 'block';

        document.getElementById('inputNameContact').setAttribute('placeholder', 'enter your id contact');
      } else if (e.value != "other") {
        document.getElementById('inputTypeNameContact').style.display = 'none';

        document.getElementById('inputNameContact').setAttribute('placeholder', 'enter your '+e.value);
      }
    }

    var widgetRecaptcha1;
    var onloadCallback = function() {
      widgetRecaptcha1 = grecaptcha.render('recaptcha1', { 'sitekey': '6Ld-_NEUAAAAAIcro-nuBeDeMigbdDBoxVt6jw9h' });
    };

    function submitContactForm() {
      var recaptcha = grecaptcha.getResponse(widgetRecaptcha1);

      $.ajax({
        url: "https://gaidadei.ru/gmer.io/post",// https://gaidadei.ru/postnodejs/
        method: "POST",
        data: {
          typeContact: $("#selectTypeContact").val(),
          typeContactName: $("#inputTypeNameContact").val(),
          idContact: $("#inputNameContact").val(),
          theme: $("#selectTypeTheme").val(),
          message: $("#messageContact").val(),
          recaptcha: recaptcha
        },
        success: function(answer) {
          answer = answer.split(":");
          if (answer[0] == "ok") {
            $("#messageAnswer").css("color", "#04a711");
            $(".strokeForm").hide();
          } else if (answer[0] == "err") {
            $("#messageAnswer").css("color", "#ff5656");
            $(".strokeForm").show();
          }
          $("#messageAnswer").html(answer[1]);
          $("#messageAnswer").show();
        }
      });
    }

    var setGuiHome = function() {
      //document.querySelectorAll('html').style.height = '100%';
      document.body.style.backgroundImage = 'url("/g/stealth/resource/img/background.png")';
      document.body.style.backgroundSize = 'cover';
      document.body.style.backgroundPosition = 'center';
      document.body.style.backgroundRepeat = 'no-repeat';
      document.body.style.height = '100vh';
      document.body.style.backgroundColor = '#000';

      // var logoGame = document.createElement('div');
      // logoGame.setAttribute('id', 'logoGame');
      // logoGame.innerHTML = 'g/stealth';
      // logoGame.style.position = 'fixed';
      // logoGame.style.left = '30px';
      // logoGame.style.top = '30px';
      // logoGame.style.fontSize = '14px';
      // logoGame.style.fontFamily = 'Arial';
      // logoGame.style.textAlign = 'left';
      // logoGame.style.color = '#fff';
      // logoGame.style.textShadow = '2px 2px 2px #000';
      // document.getElementById('guiHome').appendChild(logoGame);

      var contactButton = document.createElement('div');
      contactButton.setAttribute('id', 'contactButton');
      contactButton.setAttribute('onclick', 'showContactForm()');
      contactButton.innerHTML = 'Contact with us';
      contactButton.style.position = 'fixed';
      contactButton.style.right = '20px';
      contactButton.style.bottom = '10px';
      contactButton.style.padding = '5px';
      contactButton.style.cursor = 'pointer';
      contactButton.style.fontSize = '12px';
      contactButton.style.fontFamily = '"Arial';
      contactButton.style.color = '#fff';
      contactButton.style.backgroundColor = '#00000077';
      document.getElementById('guiHome').appendChild(contactButton);

      //insert
      var backContactForm = document.createElement('div');
      backContactForm.setAttribute('id', 'backContactForm');
      backContactForm.style.position = 'fixed';
      backContactForm.style.left = '0px';
      backContactForm.style.top = '0px';
      backContactForm.style.width = '100%';
      backContactForm.style.height = '100%';
      backContactForm.style.display = 'none';
      backContactForm.style.flexDirection = 'column';
      backContactForm.style.alignItems = 'center';
      backContactForm.style.justifyContent = 'center';
      backContactForm.style.backgroundColor = '#00000099';
      backContactForm.style.zIndex = '100';
      document.getElementById('guiHome').appendChild(backContactForm);

      var contentContactForm = document.createElement('div');
      contentContactForm.setAttribute('id', 'contentContactForm');
      contentContactForm.style.backgroundColor = '#fff';
      contentContactForm.style.width = '100%';
      contentContactForm.style.maxWidth = '600px';
      backContactForm.appendChild(contentContactForm);

      var messageAnswer = document.createElement('div');
      messageAnswer.setAttribute('id', 'messageAnswer');
      messageAnswer.style.margin = '20px';
      messageAnswer.style.textAlign = 'center';
      messageAnswer.style.fontSize = '14px';
      messageAnswer.style.fontFamily = 'Arial';
      messageAnswer.style.display = 'none';
      contentContactForm.appendChild(messageAnswer);

      var strokeIdContact = document.createElement('div');
      strokeIdContact.setAttribute('id', 'strokeIdContact');
      strokeIdContact.setAttribute('class', 'strokeForm');
      contentContactForm.appendChild(strokeIdContact);

      var selectTypeContact = document.createElement('select');
      selectTypeContact.setAttribute('id', 'selectTypeContact');
      selectTypeContact.setAttribute('class', 'inputStyle');
      selectTypeContact.setAttribute('onchange', 'refreshContactStroke(this)');
      var option = document.createElement('option');
      option.setAttribute('value', 'email');
      option.innerHTML = 'e-mail';
      selectTypeContact.appendChild(option);
      var option = document.createElement('option');
      option.setAttribute('value', 'snapchat');
      option.innerHTML = 'snapchat';
      selectTypeContact.appendChild(option);
      var option = document.createElement('option');
      option.setAttribute('value', 'telegram');
      option.innerHTML = 'telegram';
      selectTypeContact.appendChild(option);
      var option = document.createElement('option');
      option.setAttribute('value', 'other');
      option.innerHTML = 'other';
      selectTypeContact.appendChild(option);
      strokeIdContact.appendChild(selectTypeContact);

      var inputTypeNameContact = document.createElement('input');
      inputTypeNameContact.setAttribute('id', 'inputTypeNameContact');
      inputTypeNameContact.setAttribute('class', 'inputStyle');
      inputTypeNameContact.setAttribute('type', 'text');
      inputTypeNameContact.setAttribute('placeholder', 'enter what it is');
      inputTypeNameContact.style.display = 'none';
      strokeIdContact.appendChild(inputTypeNameContact);

      var inputNameContact = document.createElement('input');
      inputNameContact.setAttribute('id', 'inputNameContact');
      inputNameContact.setAttribute('class', 'inputStyle');
      inputNameContact.setAttribute('type', 'text');
      inputNameContact.setAttribute('placeholder', 'enter your e-mail');
      strokeIdContact.appendChild(inputNameContact);

      var strokeThemeContact = document.createElement('div');
      strokeThemeContact.setAttribute('id', 'strokeThemeContact');
      strokeThemeContact.setAttribute('class', 'strokeForm');
      contentContactForm.appendChild(strokeThemeContact);

      var selectTypeTheme = document.createElement('select');
      selectTypeTheme.setAttribute('id', 'selectTypeTheme');
      selectTypeTheme.setAttribute('class', 'inputStyle');
      var option = document.createElement('option');
      option.setAttribute('value', 'commercial');
      option.innerHTML = 'commercial issues';
      selectTypeTheme.appendChild(option);
      var option = document.createElement('option');
      option.setAttribute('value', 'technical');
      option.innerHTML = 'technical problems';
      selectTypeTheme.appendChild(option);
      var option = document.createElement('option');
      option.setAttribute('value', 'idea');
      option.innerHTML = 'i have the great idea';
      selectTypeTheme.appendChild(option);
      var option = document.createElement('option');
      option.setAttribute('value', 'other');
      option.innerHTML = 'other';
      selectTypeTheme.appendChild(option);
      strokeThemeContact.appendChild(selectTypeTheme);

      var strokeTextarea = document.createElement('div');
      strokeTextarea.setAttribute('id', 'strokeTextarea');
      strokeTextarea.setAttribute('class', 'strokeForm');
      contentContactForm.appendChild(strokeTextarea);

      var messageContact = document.createElement('textarea');
      messageContact.setAttribute('id', 'messageContact');
      messageContact.setAttribute('class', 'inputStyle');
      messageContact.setAttribute('placeholder', 'enter your message');
      strokeTextarea.appendChild(messageContact);

      var strokeSubmit = document.createElement('div');
      strokeSubmit.setAttribute('id', 'strokeSubmit');
      strokeSubmit.setAttribute('class', 'strokeForm');
      strokeSubmit.style.justifyContent = 'space-around';
      strokeSubmit.style.alignItems = 'center';
      strokeSubmit.style.margin = '20px 0px';
      strokeSubmit.style.display = 'flex';
      strokeSubmit.style.flexDirection = 'eow';
      contentContactForm.appendChild(strokeSubmit);

      //recaptcha
      var recaptcha1 = document.createElement('div');
      recaptcha1.setAttribute('id', 'recaptcha1');
      strokeSubmit.appendChild(recaptcha1);

      var submitContactForm = document.createElement('div');
      submitContactForm.setAttribute('id', 'submitContactForm');
      submitContactForm.setAttribute('onclick', 'submitContactForm()');
      submitContactForm.innerHTML = 'Submit';
      submitContactForm.style.padding = '15px 40px';
      submitContactForm.style.backgroundColor = '#333';
      submitContactForm.style.fontSize = '14px';
      submitContactForm.style.fontFamily = 'Arial';
      submitContactForm.style.color = '#fff';
      submitContactForm.style.cursor = 'pointer';
      submitContactForm.style.margin = '0px 20px';
      submitContactForm.style.display = 'flex';
      submitContactForm.style.flexDirection = 'column';
      submitContactForm.style.justifyContent = 'center';
      submitContactForm.style.alignItems = 'center';
      strokeSubmit.appendChild(submitContactForm);
      //--insert

      var buttonSearchGame = document.createElement('div');
      buttonSearchGame.setAttribute('id', 'searchGame');
      buttonSearchGame.setAttribute('onclick', 'switchSearchGame()');
      buttonSearchGame.setAttribute('searching', 'false');
      buttonSearchGame.innerHTML = 'Search game';
      buttonSearchGame.style.position = 'fixed';
      buttonSearchGame.style.top = '50%';
      buttonSearchGame.style.right = '20px';
      buttonSearchGame.style.marginTop = '-40px';
      buttonSearchGame.style.width = '150px';
      buttonSearchGame.style.padding = '20px';
      buttonSearchGame.style.borderRadius = '5px';
      buttonSearchGame.style.backgroundColor = '#005fc3';
      buttonSearchGame.style.color = '#fff';
      buttonSearchGame.style.fontSize = '16px';
      buttonSearchGame.style.fontFamily = 'Arial';
      buttonSearchGame.style.textAlign = 'center';
      buttonSearchGame.style.cursor = 'pointer';
      buttonSearchGame.style.transition = 'opacity 1s linear 0s';
      document.getElementById('guiHome').appendChild(buttonSearchGame);

      var inputName = document.createElement('input');
      inputName.setAttribute('id', 'inputName');
      inputName.setAttribute('type', 'text');
      inputName.setAttribute('placeholder', 'Your name');
      inputName.setAttribute('onchange', 'saveName()');
      var name = getCookie('name');
      if (name) {
        inputName.value = name;
      }
      inputName.style.position = 'fixed';
      inputName.style.top = '50%';
      inputName.style.right = '20px';
      inputName.style.width = '150px';
      inputName.style.padding = '20px';
      inputName.style.outline = 'none';
      inputName.style.border = 'none';
      inputName.style.color = '#333';
      inputName.style.marginTop = '40px';
      inputName.style.fontSize = '14px';
      inputName.style.fontFamily = 'Arial';
      inputName.style.backgroundColor = '#fff';
      inputName.style.textAlign = 'center';
      inputName.style.borderRadius = '5px';
      document.getElementById('guiHome').appendChild(inputName);

      if (onloadCallback) {
        widgetRecaptcha1 = grecaptcha.render('recaptcha1', { 'sitekey': '6Ld-_NEUAAAAAIcro-nuBeDeMigbdDBoxVt6jw9h' });
      }
    };

    var initHome = function() {
      clearGame();

      clearInterval(controlerInterval1);
      clearInterval(controlerInterval2);
      clearInterval(controlerInterval3);

      var guiHomeDom = document.createElement('div');
      guiHomeDom.setAttribute('id', 'guiHome');
      document.body.appendChild(guiHomeDom);

      setGuiHome();

      var textDom = document.createElement('div');
      textDom.setAttribute('searching', false);
      textDom.setAttribute('id', 'textSearchingGame');
      textDom.innerHTML = 'press 1 to search game';
      document.getElementById('guiHome').appendChild(textDom);

      //+Listeners home
      window.addEventListener("keydown", keyDownHome);
      window.addEventListener("keyup", keyUpHome);
      //-Listeners home
    };
    var clearHome = function() {
      document.getElementById('guiHome').remove();

      window.removeEventListener("keydown", keyDownHome);
      window.removeEventListener("keyup", keyUpHome);
    };

    var scene, camera, renderer, eyesLight, targetEyesLight, finishData, timeStartGame, finishDataBots;
    var initGame = function() {
    clearHome();
    finishData = {};
    finishDataBots = [];
    timeStartGame = Date.now();

    scene = new THREE.Scene();

    camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 1, 1000);
    camera.position.z = 50;
    scene.add(camera);

    renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.shadowMap.enabled = true;
		renderer.shadowMap.type = THREE.PCFSoftShadowMap;
		// renderer.outputEncoding = THREE.sRGBEncoding;
    var domObjRenderer = renderer.domElement;
    domObjRenderer.setAttribute('id', 'gameCanvas');
    domObjRenderer.style.marginLeft = '5px';
    domObjRenderer.style.marginTop = '5px';
    document.body.appendChild(domObjRenderer);
    document.body.style.backgroundColor = '#000';
    document.body.style.backgroundImage = 'none';
    setSizeWindow();

    var light = new THREE.AmbientLight(0xFFFFFF, 0.3);
    scene.add(light);
    // var light = new THREE.PointLight(0xFFFFFF, 0.3, 50);
    // light.position.set(0, 0, 3);
    //scene.add(light);

    targetEyesLight = new THREE.Object3D();
    targetEyesLight.position.z = 0.5;
    scene.add(targetEyesLight);
    eyesLight = new THREE.SpotLight(0xFFFFFF, 0.5);
    eyesLight.position.z = 0.5;
		eyesLight.angle = Math.PI/4;
		eyesLight.penumbra = 0;
		eyesLight.decay = 1;
		eyesLight.distance = 50;
    eyesLight.castShadow = true;
    eyesLight.target = targetEyesLight;
    eyesLight.shadow.mapSize.width = 200;
		eyesLight.shadow.mapSize.height = 200;
		eyesLight.shadow.camera.near = 0.01;
		eyesLight.shadow.camera.far = 200;
    scene.add(eyesLight);
    loop();

    //+Listeners game
    window.addEventListener("resize", setSizeWindow);
    window.addEventListener("keydown", keyDownGame);
    window.addEventListener("keyup", keyUpGame);
    window.addEventListener("mousemove", rotateMe);
    document.addEventListener("contextmenu", cancelContextRightClick);
    window.addEventListener("mousedown", aimGunDown);
    window.addEventListener("mouseup", aimGunUp);
    window.addEventListener("wheel", changeWeapon);
    window.addEventListener("mousedown", stab);
    window.addEventListener("mousedown", shoot);
    window.addEventListener("keydown", keyDownGame);
    //-Listeners game
    //+FPS
    //javascript:(function(){var script=document.createElement('script');script.onload=function(){var stats=new Stats();document.body.appendChild(stats.dom);requestAnimationFrame(function loop(){stats.update();requestAnimationFrame(loop)});};script.src='//mrdoob.github.io/stats.js/build/stats.min.js';document.head.appendChild(script);})()
    //-FPS
    };
    var clearGame = function() {
      if (document.getElementById('gameCanvas')) {
        document.getElementById('gameCanvas').remove();
        document.getElementById('finishDisplay').remove();
        scene.remove.apply(scene, scene.children);

        window.removeEventListener("resize", setSizeWindow);
        window.removeEventListener("keydown", keyDownGame);
        window.removeEventListener("keyup", keyUpGame);
        window.removeEventListener("mousemove", rotateMe);
        document.removeEventListener("contextmenu", cancelContextRightClick);
        window.removeEventListener("mousedown", aimGunDown);
        window.removeEventListener("mouseup", aimGunUp);
        window.removeEventListener("wheel", changeWeapon);
        window.removeEventListener("mousedown", stab);
        window.removeEventListener("mousedown", shoot);
        window.removeEventListener("keydown", keyDownGame);
      }
    };

    var exitToHome = function() {
      initHome();
      socket.emit('exitToMainMenuS');
    };

    //+listeners io
    socket.on('startRoomS', function(players) {
      initGame();
      respawn();
      finishData.place = players;
    });
    socket.on('addObjectsS', function(arrObjects) {
      for (var i = 0; i < arrObjects.length; i++) {
        objects[arrObjects[i].id] = arrObjects[i];
        addScene(arrObjects[i]);
      }
    });
    socket.on('takeIdObjPlayerS', function(idObj) {
      idObjMyPlayer = idObj;
    });
    var layoutRoom;
    socket.on('takeLayoutS', function(layout) {
      layoutRoom = layout;
      console.log("layout: "+layoutRoom);
    });
    socket.on('chgSpeedPlayerS', function(idObj, speedx, speedy) {
      if (speedx != null) {
        objects[idObj].speed.x = speedx;
      }
      if (speedy != null) {
        objects[idObj].speed.y = speedy;
      }
      if (idObj == idObjMyPlayer && objects[idObj].speed.x == 0 && objects[idObj].speed.y == 0) {
        countStep = maxCountStep-1;
      }
    });
    socket.on('updateCoordS', function() {
      socket.emit('sendMyCoordToAllS', idObjMyPlayer, objects[idObjMyPlayer].coord);
    });
    socket.on('takeNewCoordPlayerS', function(idObj, coords) {
      objects[idObj].coord = coords;
      objects[idObj].sceneObj.position.x = coords.x;
      objects[idObj].sceneObj.position.y = coords.y;
    });
    socket.on('takeNewRotatePlayerS', function(idObj, angle, direct) {
      objects[idObj].sceneObj.rotation.y = angle;
      objects[idObj].lookingDirect = direct;
    });
    socket.on('takeActionS', function(idObj, action, param) {
      switch (action) {
        case 'aiming':
          objects[idObj].aiming = param;
          break;
        case 'changeWeapon':
          objects[idObj].activeWeapon = param;
          if (obj.activeWeapon == 1) {
            visibleObj(obj, "GunObj", true);
            visibleObj(obj, "KnifeObj", false);
          } else if (obj.activeWeapon == 2) {
            visibleObj(obj, "GunObj", false);
            visibleObj(obj, "KnifeObj", true);
          }
          break;
        case 'stab':
          makeStab(objects[idObj]);
          break;
        default:

      }
    });
    socket.on('takeChgHpBloodS', function(idPlayer, hp, blood) {
      objects[idPlayer].health -= hp;
      objects[idPlayer].bleeding += blood;
    });
    socket.on('takeDeadPlayerS', function(idPlayer) {
      objects[idPlayer].dead = true;
      objects[idPlayer].sceneObj.rotation.x = 0;
      objects[idPlayer].sceneObj.rotation.y = 0;
      objects[idPlayer].sceneObj.rotation.z = Math.PI/2;
      objects[idPlayer].sceneObj.position.z = 1;
      objects[idPlayer].mixer.stopAllAction();
      objects[idPlayer].mixer.clipAction(THREE.AnimationClip.findByName(objects[idPlayer].animations, 'Standing')).play();
      objects[idPlayer].mixer.clipAction(THREE.AnimationClip.findByName(objects[idPlayer].animations, 'GunStanding')).play();
      objects[idPlayer].mixer.clipAction(THREE.AnimationClip.findByName(objects[idPlayer].animations, 'KnifeStanding')).play();
      objects[idPlayer].health = 0;
      objects[idPlayer].bleeding = 0;
      objects[idPlayer].stopBullet = false;

      if (!objects[idObjMyPlayer].dead) {
        finishData.place--;
      }
    });
    socket.on('removePlayerS', function(idObj) {
      scene.remove(objects[idObj].sceneObj);
      delete objects[idObj];
    });
    socket.on('takeCreateFinishDataBotsS', function(data) {
      finishDataBots = data;
    });
    socket.on('takeFinishDataS', function() {
      finishData.name = objects[idObjMyPlayer].name;
      if (typeof finishData.time == 'undefined') { finishData.time = Math.round((Date.now()-timeStartGame)/1000); }
      if (typeof finishData.steps == 'undefined') { finishData.steps = 0; }
      if (typeof finishData.shoots == 'undefined') { finishData.shoots = 0; }
      if (typeof finishData.spotsBlood == 'undefined') { finishData.spotsBlood = 0; }
      if (amicontrolerbot) {
        for (var i = 0; i < finishDataBots.length; i++) {
          if (finishDataBots[i].place == 1) {
            finishDataBots[i].time = Math.round((Date.now()-finishDataBots[i].time)/1000);
            socket.emit('sendCreateFinishDataBotsS', finishDataBots);
          }
        }
      }
      finishData.kills = objects[idObjMyPlayer].killing.length;
      socket.emit('giveFinishDataS', finishData);
    });
    socket.on('finishGameS', function(data) {
      for (i in finishDataBots) {
        finishDataBots[i].kills = finishDataBots[i].kills.length;
      }
      var k = 0;
      var l = data.length;
      for (i in finishDataBots) {
        data[l+k] = finishDataBots[i];
        k++;
      }

      var finishDisplay = document.createElement("div");
      finishDisplay.setAttribute("id", "finishDisplay");
      finishDisplay.style.width = "100%";
      finishDisplay.style.height = "100%";
      finishDisplay.style.position = "absolute";
      finishDisplay.style.left = "0px";
      finishDisplay.style.bottom = "0px";
      finishDisplay.style.display = "flex";
      finishDisplay.style.flexDirection = "column";
      finishDisplay.style.justifyContent = "center";
      finishDisplay.style.alignItems = "center";
      finishDisplay.style.backgroundColor = "#00000077";
      finishDisplay.style.zIndex = "100";
      document.getElementById('guitag').appendChild(finishDisplay);

      var blockFinish = document.createElement("div");
      blockFinish.setAttribute("id", "blockFinish");
      blockFinish.style.width = "100%";
      blockFinish.style.maxWidth = "600px";
      blockFinish.style.display = "flex";
      blockFinish.style.flexDirection = "column";
      blockFinish.style.alignItems = "center";
      finishDisplay.appendChild(blockFinish);

      var tableFinish = document.createElement("table");
      tableFinish.setAttribute("id", "tableFinish");

      var tr = document.createElement("tr");
      var th = document.createElement("th");
      th.innerHTML = 'place';
      tr.appendChild(th);
      var th = document.createElement("th");
      th.innerHTML = 'name';
      tr.appendChild(th);
      var th = document.createElement("th");
      th.innerHTML = 'time';
      tr.appendChild(th);
      var th = document.createElement("th");
      th.innerHTML = 'kills';
      tr.appendChild(th);
      var th = document.createElement("th");
      th.innerHTML = 'spots blood';
      tr.appendChild(th);
      var th = document.createElement("th");
      th.innerHTML = 'steps';
      tr.appendChild(th);
      tableFinish.appendChild(tr);

      for (var i = 1; i <= data.length; i++) {
      for (var j = 0; j < data.length; j++) {
      if (data[j].place == i) {
        var tr = document.createElement("tr");
        var td = document.createElement("td");
        td.innerHTML = data[j].place;
        tr.appendChild(td);
        var td = document.createElement("td");
        td.innerHTML = data[j].name;
        tr.appendChild(td);
        var td = document.createElement("td");
        td.innerHTML = data[j].time;
        tr.appendChild(td);
        var td = document.createElement("td");
        td.innerHTML = data[j].kills;
        tr.appendChild(td);
        var td = document.createElement("td");
        td.innerHTML = data[j].spotsBlood;
        tr.appendChild(td);
        var td = document.createElement("td");
        td.innerHTML = data[j].steps;
        tr.appendChild(td);
        tableFinish.appendChild(tr);
        break;
      }
      }
      }

      tableFinish.style.backgroundColor = "#fff";
      tableFinish.style.borderSpacing = '0px';
      var trs = tableFinish.querySelectorAll('tr');
      if (typeof trs[1] != 'undefined') {
        trs[1].style.backgroundColor = '#ffd70077';
      }
      if (typeof trs[2] != 'undefined') {
        trs[2].style.backgroundColor = '#c0c0c077';
      }
      if (typeof trs[3] != 'undefined') {
        trs[3].style.backgroundColor = '#cd7f3277';
      }
      var ths = tableFinish.querySelectorAll('tr th');
      for (i = 0; i < ths.length; i++) {
        ths[i].style.color = "#999";
        ths[i].style.fontSize = "10px";
        ths[i].style.fontFamily = "Arial";
        ths[i].style.padding = "15px";
        ths[i].style.fontWeight = "100";
        ths[i].style.textAlign = "center";
      }
      var tds = tableFinish.querySelectorAll('tr td');
      for (i = 0; i < tds.length; i++) {
        tds[i].style.color = "#333";
        tds[i].style.fontSize = "16px";
        tds[i].style.fontFamily = "Arial";
        tds[i].style.padding = "15px";
        tds[i].style.textAlign = "center";
      }
      var tds = tableFinish.querySelectorAll('tr th, tr td');
      for (i = 0; i < tds.length; i++) {
        tds[i].style.borderBottom = "1px solid #ddd";
        tds[i].style.borderRight = "1px solid #ddd";
      }
      var tds = tableFinish.querySelectorAll('tr:last-child th, tr:last-child td');
      for (i = 0; i < tds.length; i++) {
        tds[i].style.borderBottom = "none";
      }
      var tds = tableFinish.querySelectorAll('tr th:last-child, tr td:last-child');
      for (i = 0; i < tds.length; i++) {
        tds[i].style.borderRight = "none";
      }

      blockFinish.appendChild(tableFinish);

      //console.log(finishDataBots);

      var buttonExit = document.createElement("div");
      buttonExit.setAttribute("id", "buttonExit");
      buttonExit.setAttribute("onclick", "exitToHome()");
      buttonExit.innerHTML = 'Exit to menu';
      buttonExit.style.margin = '30px 0px';
      buttonExit.style.padding = '20px';
      buttonExit.style.cursor = 'pointer';
      buttonExit.style.fontSize = '14px';
      buttonExit.style.color = '#fff';
      buttonExit.style.fontFamily = 'Arial';
      buttonExit.style.backgroundColor = '#ff5e5e';
      buttonExit.style.borderRadius = '10px';
      blockFinish.appendChild(buttonExit);
    });
    var amicontrolerbot = false;
    socket.on('makeBotControler', function(players) {
      amicontrolerbot = true;
      console.log('i am controler');
    });
    //-listeners io

    //cookie
    function setCookie(cname, cvalue, exdays) {
      var d = new Date();
      d.setTime(d.getTime()+(exdays*24*60*60*1000));
      var expires = "expires="+d.toUTCString()+";";
      if (exdays == 0) {
        expires = "";
      }
      document.cookie = cname+"="+cvalue+";"+expires+"path=/";
    }

    function getCookie(name) {
      var cookie = document.cookie;
      cookie = cookie.split("; ");
      for (var i = 0; i < cookie.length; i++) {
        var oneCookie = cookie[i].split("=");
        if (name == oneCookie[0]) {
          return oneCookie[1];
        }
      }
      return false;
    }

    function removeCookie(name) {
      document.cookie = name+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
    }
    </script>

    <style>
      body {
        margin: 0px;
        padding: 0px;
        background-color: #fff;
      }
      .disable-select {
        user-select: none; /* supported by Chrome and Opera */
        -webkit-user-select: none; /* Safari */
        -khtml-user-select: none; /* Konqueror HTML */
        -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
      }
      /* insert */
      textarea.inputStyle {
        resize: none;
        height: 100px;
      }
      .strokeForm {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: space-around;
      }
      .inputStyle {
        margin: 10px;
        flex: 1;
        font-family: Arial;
        font-size: 14px;
        padding: 10px 15px;
        outline: none;
        color: #333;
        background-color: #fff;
        border: 2px solid #fff;
        border-bottom: 1px solid #ddd;
      }
      /* insert */
    </style>
  </body>
</html>
