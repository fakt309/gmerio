<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <script src="/socket.io/socket.io.js"></script>
    <script type="text/javascript">
      var socket = io();
      console.log(window.location.href);
      socket.emit('queryLink', window.location.href);

      socket.on('responsQueryLink', function(action, p1, p2) {
        console.log('client: '+action+' '+p1);
        switch (action) {
          case 'redirect':
            window.location.replace(p1);
            break;
          case 'errorMessage':
            setCookie('error', p1, 1, '/');
            //window.location.replace('/');
            break;
          case 'signin':
            setCookie('signinMail', p1, 30, '/');
            //window.location.replace('/u');
            break;
        }
      });

      function setCookie(cname, cvalue, exdays, path) {
        var d = new Date();
        d.setTime(d.getTime() + (exdays*24*60*60*1000));
        var expires = "expires="+ d.toUTCString();
        document.cookie = cname+"="+cvalue+";"+expires+";path="+path;
      }
    </script>
  </body>
</html>
